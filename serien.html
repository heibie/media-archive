---
layout: default
title: TV-Serien
permalink: /serien/
---

<h1>ðŸ“º TV-Serien</h1>
<p class="muted">Sortiert nach <em>zuletzt gesehen</em> (neu â†’ alt). Klicke auf eine Serie, um alle Episoden einzublenden.</p>

<div class="controls">
  <div class="group">
    <label for="q">Suche:</label>
    <input id="q" type="search" placeholder="Serien-Titel â€¦">
  </div>
  <span class="pill muted" id="count"></span>
</div>

<div id="shows">
{% assign eps = site.data.watched_episodes %}
{% assign groups = eps | group_by: "show" %}
{% for g in groups %}
  {% assign list = g.items | sort: "watched_on" | reverse %}
  {% assign latest = list[0] %}
  {% assign total = g.items | size %}

  <section class="show"
           data-title="{{ g.name | downcase }}"
           data-latest="{{ latest.watched_on | default: '' }}">
    <div class="row">
      <div>
        <img class="poster" src="{{ latest.show_poster | default: '/assets/placeholder.png' }}" alt="Poster {{ g.name | escape }}" loading="lazy">
      </div>
      <div>
        <h2 style="margin:.2rem 0 .3rem 0;">{{ g.name }}</h2>
        <div class="meta">
          {% if latest.year %}<span class="pill">{{ latest.year }}</span>{% endif %}
          <span class="pill">{{ total }} Episoden</span>
          {% if latest.watched_on %}
            <span class="muted">zuletzt gesehen: {{ latest.watched_on | date: "%d.%m.%Y" }}</span>
          {% endif %}
          {% if latest.imdb %} Â· <a href="https://www.imdb.com/title/{{ latest.imdb }}/" target="_blank" rel="noopener">IMDb</a>{% endif %}
          {% if latest.tmdb %} Â· <a href="https://www.themoviedb.org/tv/{{ latest.tmdb }}" target="_blank" rel="noopener">TMDB</a>{% endif %}
        </div>
      </div>
    </div>

   <details>
  <summary>Episoden anzeigen</summary>
  <div class="episodes">
    <ul>
    {% for ep in list %}
      {%- comment -%} Robust in Zahlen wandeln {%- endcomment -%}
      {% assign se_num = ep.season  | plus: 0 %}
      {% assign en_num = ep.episode | plus: 0 %}

      {%- comment -%} Zweistellig formatieren (01, 02, â€¦) {%- endcomment -%}
      {% capture se_str %}{% if se_num < 10 %}0{{ se_num }}{% else %}{{ se_num }}{% endif %}{% endcapture %}
      {% capture en_str %}{% if en_num < 10 %}0{{ en_num }}{% else %}{{ en_num }}{% endif %}{% endcapture %}

      <li>
        S{{ se_str }}E{{ en_str }}
        {% if ep.watched_on %} {{ ep.episode_title_de | default: ep.episode_title }} â€“ gesehen am {{ ep.watched_on | date: "%d.%m.%Y" }}{% endif %}
        {% if ep.episode_still %} Â· <a href="{{ ep.episode_still }}" target="_blank" rel="noopener">Still</a>{% endif %}
      </li>
    {% endfor %}
    </ul>
  </div>
</details>

  </section>
{% endfor %}
</div>

<script>
(function(){
  const q = document.getElementById('q');
  const list = document.getElementById('shows');
  const items = Array.from(list.querySelectorAll('.show'));
  const count = document.getElementById('count');

  function sortByLatest() {
    items.sort((a,b)=>{
      const da = a.dataset.latest || '';
      const db = b.dataset.latest || '';
      if (!da && !db) return 0;
      if (!da) return 1;
      if (!db) return -1;
      return db.localeCompare(da);
    }).forEach(el => list.appendChild(el));
  }

  function apply(){
    const term = (q.value || '').trim().toLowerCase();
    sortByLatest();
    let visible = 0;
    for (const el of items){
      const hit = !term || (el.dataset.title || '').includes(term);
      el.style.display = hit ? '' : 'none';
      if (hit) visible++;
    }
    if (count) count.textContent = visible + ' Serien';
  }
  q.addEventListener('input', apply);
  apply();
})();
</script>
